name: Test & Build MRP System

on: [push]

jobs:
  run-unit-tests:

    runs-on: ubuntu-latest

    steps:
    - name: Checkout Project
      uses: actions/checkout@v4
    - name: Run API Tests
      uses: .github/workflows/test-api.yml

  
  attempt-build:

    runs-on: ubuntu-latest

    needs: [
      run-unit-tests
    ]

    steps:
      - name: Checkout Project
        uses: actions/checkout@v4
      - name: Attempt to Build MRP Project
        run: sudo docker compose -f app/docker-compose.yaml up -d --build
      - name: Stop Containers
        if: always()
        run: docker-compose -f app/docker-compose.yaml down
  
  # build-and-deploy:

  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: Checkout Project
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis
